<!DOCTYPE html>
<html lang="en">

<head>
    <title>
        {{ config["PROJECT"] }} @ {{ config["COMPANY"] }}
    </title>

    <meta charset="utf-8"/>
    <link rel="icon" type="image/png" href="/static/assets/favicon-48.png" />
    <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width"/>

    <style type="text/css">
        @media (prefers-color-scheme: dark) {
            body {
                background: #121212;
            }
        }
        @media (prefers-color-scheme: light) {
            body {
                background: #ffffff;
            }
        }
    </style>

    <script crossorigin src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@17.0.2/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17.0.2/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@material-ui/core@4.11.3/umd/material-ui.development.js"></script>
    <srcipt src="https://unpkg.com/react-markdown@5.0.3/react-markdown.min.js"></srcipt>

    <script type="text/label" src="/dynamic/js/config.js"></script>
    <script type="text/babel" src="/static/js/drawer.js"></script>
    <script type="text/babel" src="/static/js/appbar.js"></script>
    <script type="text/babel" src="/static/js/cards.js"></script>
    <script type="text/babel" src="/static/js/inputs.js"></script>
    <script type="text/babel" src="/static/js/output.js"></script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" /> 
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
</head>


<body><div id="root"></div>
<script type="text/babel">

var CONFIG = {
    COMPANY: '{{ config["COMPANY"] }}',
    PROJECT: '{{ config["PROJECT"] }}',
    VERSION: '{{ config["VERSION"] }}',
    
    EMAIL: '{{ config["EMAIL"] }}',
    GITHUB: '{{ config["GITHUB"] }}',
    WEBSITE: '{{ config["WEBSITE"] }}',
    LINKEDIN: '{{ config["LINKEDIN"] }}',
    
    INPUTS: JSON.parse('{{ inputs | tojson }}'),
    OUTPUT: JSON.parse('{{ output | tojson }}'),
    SITEMAP: JSON.parse('{{ sitemap | tojson }}'),
    METADATA: JSON.parse('{{ metadata | tojson }}'),
}


const {
    colors,
    CssBaseline,
    ThemeProvider,
    createMuiTheme,
    useMediaQuery,
    Container,
    Box,
    Grid,
    Button,
} = MaterialUI

const { useMemo } = React


const theme = mode => createMuiTheme(
    mode == 'dark' 
    ? {
        palette: {
            type: 'dark',
            background: {
                default: '#121212',
                paper: '#1E1E1E',
            },
            primary: {
                main: '#BB86FC',
            },
            secondary: {
                main: '#03DAC5',
            },
            error: {
                main: '#CF6679',
            },
        },
    } 
    : {
        palette: {
            type: 'light',
            background: {
                default: '#FFFFFF',
                paper: '#FFFFFF',
            },
            primary: {
                main: '#6200EE',
            },
            secondary: {
                main: '#03DAC6',
            },
            error: {
                main: '#B00020',
            },
        },
    }
)


function Root(props) {
    const darkMode = useMediaQuery('(prefers-color-scheme: dark)')
    const mode = useMemo(() => darkMode ? "dark" : "light", [darkMode])
return (

<ThemeProvider theme={theme(mode)}>
<CssBaseline/>
    <MainAppBar
        endpoint={ CONFIG.METADATA.name }
        github={ CONFIG.GITHUB }
        website={ CONFIG.WEBSITE }
        email={ CONFIG.EMAIL }
        linkedin={ CONFIG.LINKEDIN }
        drawer={ <MainDrawer sitemap={ CONFIG.SITEMAP }/> }
    />
<Container>
<Box my={2}>

{ window.location.pathname == '/'
? (

    <Card>
    <CardContent>
        {{ readme|safe }}
    </CardContent>
    </Card>

) : (
    <Grid 
        container spacing={1} 
        direction="row"
    >
        <Grid item 
            xs={12} 
            md={6}
        >
            <FormCard>
                <CardHeader>
                    { CONFIG.METADATA.doc }
                </CardHeader>
                    { render_input(CONFIG.INPUTS) }
            </FormCard>
        </Grid>

        <Grid item
            xs={12} 
            lg={6} 
        >
            <Card>
                { render_output(CONFIG.OUTPUT) }
            </Card>
        </Grid>
    </Grid>
)}

</Box>
</Container>
</ThemeProvider>

)}

ReactDOM.render(<Root key="root"/>, document.querySelector('#root'));

</script>
</body>
</html>

